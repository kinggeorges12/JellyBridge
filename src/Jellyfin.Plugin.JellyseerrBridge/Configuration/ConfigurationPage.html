<div id="jellyseerrBridgeConfigurationPage" data-role="page" class="page type-interior pluginConfigurationPage" data-controller="__plugin/ConfigurationPage.js">
    <div data-role="content">
        <div class="content-primary">
            <style>
                summary {
                    cursor: pointer;
                    padding: 10px;
                    width: inherit;
                    margin: auto;
                    border: none;
                    text-align: center;
                    font-size: 1em;
                    outline: 2px solid rgba(155, 155, 155, 0.5);
                }
                h3.checkboxListLabel {
                    font-size: 1em;
                    margin-bottom: 4px;
                }
                /* Disabled state styling */
                .disabled-block {
                    opacity: .6;
                }
                .disabled-block input,
                .disabled-block select,
                .disabled-block button {
                    pointer-events: none;
                }
                .disabled-block .inputLabel,
                .disabled-block label.emby-checkbox-label span {
                    font-style: italic;
                }
            </style>
            <form id="jellyseerrBridgeConfigurationForm">
                <fieldset class="verticalSection-extrabottompadding">
                    <legend>Jellyseerr Bridge Configuration</legend>
                    
                    <div class="checkboxContainer">
                        <label class="emby-checkbox-label">
                            <input is="emby-checkbox" type="checkbox" id="IsEnabled" />
                            <span>Enable Plugin</span>
                        </label>
                    </div>

                    <div class="inputContainer">
                        <input is="emby-input" type="url" id="JellyseerrUrl" label="Jellyseerr URL" required value="http://localhost:5055" />
                        <div class="fieldDescription">The base URL of your Jellyseerr instance (e.g., http://localhost:5055)</div>
                    </div>

                    <div class="inputContainer">
                        <input is="emby-input" type="password" id="ApiKey" label="API Key" autocomplete="off" data-lpignore="true" data-form-type="other" />
                        <div class="fieldDescription">Your Jellyseerr API key</div>
                    </div>

                    <div>
                        <button is="emby-button" type="button" id="testConnection" class="raised button block emby-button">
                            <span>Test Connection</span>
                        </button>
                    </div>

                    <div class="inputContainer">
                        <input is="emby-input" type="number" id="UserId" label="User ID" value="1" />
                        <div class="fieldDescription">Jellyseerr user ID for requests</div>
                    </div>

                    <div class="inputContainer">
                        <input is="emby-input" type="number" id="SyncIntervalHours" label="Sync Interval (Hours)" value="24" />
                        <div class="fieldDescription">How often to sync with Jellyseerr (in hours)</div>
                    </div>

                    <br>

                    <details id="librarySettings">
                        <summary>Library Settings</summary>
                        <br>
                        <div class="inputContainer">
                            <input is="emby-input" type="text" id="LibraryDirectory" label="Library Directory" value="/data/Jellyseerr" />
                            <div class="fieldDescription">Directory path for Jellyseerr library files</div>
                        </div>

                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input id="ExcludeFromMainLibraries" type="checkbox" is="emby-checkbox" data-embycheckbox="true" class="emby-checkbox" />
                                <span class="checkboxLabel">Exclude placeholder shows from main libraries</span>
                                <span class="checkboxOutline">
                                    <span class="material-icons checkboxIcon checkboxIcon-checked check" aria-hidden="true"></span>
                                    <span class="material-icons checkboxIcon checkboxIcon-unchecked" aria-hidden="true"></span>
                                </span>
                            </label>
                            <div class="fieldDescription">When enabled, placeholder shows from streaming services will be excluded from your main Jellyfin libraries.</div>
                        </div>

                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input id="CreateSeparateLibraries" type="checkbox" is="emby-checkbox" data-embycheckbox="true" class="emby-checkbox" />
                                <span class="checkboxLabel">Create separate libraries for streaming services</span>
                                <span class="checkboxOutline">
                                    <span class="material-icons checkboxIcon checkboxIcon-checked check" aria-hidden="true"></span>
                                    <span class="material-icons checkboxIcon checkboxIcon-unchecked" aria-hidden="true"></span>
                                </span>
                            </label>
                            <div class="fieldDescription">When enabled, separate libraries will be created for each streaming service (Netflix, Hulu, etc.)</div>
                        </div>

                        <div class="inputContainer">
                            <label class="inputLabel inputLabelUnfocused" for="LibraryPrefix">Library Prefix</label>
                            <input id="LibraryPrefix" type="text" is="emby-input" class="emby-input" />
                            <div class="fieldDescription">Prefix for streaming service library names (e.g., "Streaming - ")</div>
                        </div>
                    </details>

                    <br>

                    <details id="syncSettings">
                        <summary>Sync Settings</summary>
                        <br>

                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input id="AutoSyncOnStartup" type="checkbox" is="emby-checkbox" data-embycheckbox="true" class="emby-checkbox" />
                                <span class="checkboxLabel">Auto-sync on Plugin Startup</span>
                                <span class="checkboxOutline">
                                    <span class="material-icons checkboxIcon checkboxIcon-checked check" aria-hidden="true"></span>
                                    <span class="material-icons checkboxIcon checkboxIcon-unchecked" aria-hidden="true"></span>
                                </span>
                            </label>
                            <div class="fieldDescription">Automatically perform a sync operation when the plugin starts up or when Jellyfin restarts.</div>
                        </div>

                        <div class="inputContainer">
                            <label class="inputLabel inputLabelUnfocused" for="WatchProviderRegion">Watch Provider Region</label>
                            <select id="WatchProviderRegion" is="emby-select" class="emby-select">
                                <option value="US">United States of America (United States)</option>
                            </select>
                            <div class="fieldDescription">Select your region for watch provider information. This determines which streaming services are shown for movies and TV shows.</div>
                        </div>

                        <div class="inputContainer">
                            <label class="inputLabel inputLabelUnfocused" for="DefaultNetworks">Default Networks</label>
                            <div class="multiSelectContainer" style="display: flex; gap: 20px; margin-top: 10px;">
                                <!-- Active Providers (Left) -->
                                <div class="selectBox" style="flex: 1;">
                                    <div class="selectBoxHeader" style="display: flex; align-items: center; margin-bottom: 8px;">
                                        <label class="inputLabel" style="margin: 0; flex: 1;">Active Providers</label>
                                        <button type="button" id="removeSelected" class="emby-button" style="padding: 4px 8px; font-size: 12px;">Remove</button>
                                    </div>
                                    <input type="text" id="activeSearch" placeholder="Search active providers..." style="width: 100%; margin-bottom: 8px; padding: 6px; border: 1px solid #ccc; border-radius: 4px;">
                                    <select id="activeProviders" multiple size="8" style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; background: #f9f9f9;">
                                        <!-- Active providers will be populated here -->
                                    </select>
                                </div>
                                
                                <!-- Available Providers (Right) -->
                                <div class="selectBox" style="flex: 1;">
                                    <div class="selectBoxHeader" style="display: flex; align-items: center; margin-bottom: 8px;">
                                        <label class="inputLabel" style="margin: 0; flex: 1;">Available Providers</label>
                                        <button type="button" id="addSelected" class="emby-button" style="padding: 4px 8px; font-size: 12px;">Add</button>
                                    </div>
                                    <input type="text" id="availableSearch" placeholder="Search available providers..." style="width: 100%; margin-bottom: 8px; padding: 6px; border: 1px solid #ccc; border-radius: 4px;">
                                    <select id="availableProviders" multiple size="8" style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; background: #f9f9f9;">
                                        <!-- Available providers will be populated here -->
                                    </select>
                                </div>
                            </div>
                            <div class="fieldDescription">Select providers from the right box and move them to the left box. Use the search boxes to filter providers. Active providers will be used for filtering and categorization.</div>
                        </div>

                        <div>
                            <button is="emby-button" type="button" id="manualSync" class="raised button block emby-button">
                                <span>Manual Sync</span>
                            </button>
                        </div>
                    </details>

                    <br>

                    <details id="advancedSettings">
                        <summary>Advanced Configuration</summary>
                        <br>
                        <div class="inputContainer">
                            <label class="inputLabel inputLabelUnfocused" for="RequestTimeout">Request Timeout (seconds)</label>
                            <input id="RequestTimeout" type="number" is="emby-input" min="5" max="300" class="emby-input" />
                            <div class="fieldDescription">Timeout for API requests to Jellyseerr. Default is 30 seconds.</div>
                        </div>

                        <div class="inputContainer">
                            <label class="inputLabel inputLabelUnfocused" for="RetryAttempts">Retry Attempts</label>
                            <input id="RetryAttempts" type="number" is="emby-input" min="0" max="10" class="emby-input" />
                            <div class="fieldDescription">Number of retry attempts for failed requests. Default is 3.</div>
                        </div>

                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input id="EnableDebugLogging" type="checkbox" is="emby-checkbox" data-embycheckbox="true" class="emby-checkbox" />
                                <span class="checkboxLabel">Enable Debug Logging</span>
                                <span class="checkboxOutline">
                                    <span class="material-icons checkboxIcon checkboxIcon-checked check" aria-hidden="true"></span>
                                    <span class="material-icons checkboxIcon checkboxIcon-unchecked" aria-hidden="true"></span>
                                </span>
                            </label>
                            <div class="fieldDescription">Enable detailed debug logging for troubleshooting. This will generate more verbose logs in the Jellyfin server logs.</div>
                        </div>

                    </details>

                    <br>

                    <div>
                        <button is="emby-button" type="submit" id="saveConfig" class="raised button-submit block emby-button">
                            <span>Confirm</span>
                        </button>
                    </div>
                </fieldset>
            </form>
            
            <div style="margin-top: 20px; padding: 15px; background-color: rgba(0,0,0,0.1); border-radius: 5px; font-size: 0.9em; color: #888;">
                <p><strong>Credits & Acknowledgments:</strong></p>
                <p>Thank you to the creator of the <a href="https://github.com/geekfreak21/Overseer-and-Jellyfin-Bridged" target="_blank" style="color: #2196f3;">Overseer-Jellyfin Bridge Script</a> for the inspiration. Special thanks to the developers of the <a href="https://github.com/intro-skipper" target="_blank" style="color: #2196f3;"><strong>Intro Skipper</strong></a> and <a href="https://github.com/IAmParadox27/jellyfin-plugin-custom-tabs" target="_blank" style="color: #2196f3;"><strong>Custom Tabs</strong></a> plugins for reusing their GPL-licensed code in the UI styling and configuration patterns.</p>
            </div>
        </div>
    </div>
</div>